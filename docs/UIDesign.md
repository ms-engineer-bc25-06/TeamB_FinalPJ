# 画面設計

## 画面一覧・概要図

https://www.tldraw.com/f/YGLYadn0oAHt69EsUvl-o?d=v-1478.-1402.6836.3423.BiPFsJDcaW0JJ2k_a4cmc

## 画面一覧・仕様

各画面における構成要素、目的、機能、画面遷移の概要を以下に記載する。

### 1. ログイン画面 (`/login`)
**目的**
保護者がGoogleアカウントで安全にログインし、個別データを利用できるようにする。

**構成要素**
- 背景画像（`/images/background.webp`）
- ログインカード（白背景、角丸20px）
- Googleログインボタン
- 戻るボタン（ホーム画面へ遷移）

**実装ファイル**: `frontend/src/app/(public)/login/page.tsx`

### 2. ホーム画面（パブリック） (`/`)
**目的**
アプリの紹介とログインへの導線を提供する。

**構成要素**
- アプリタイトル画像（`/images/app_title.webp`）
- 背景画像（`/images/publictopbackground.webp`）
- ログインボタン（ログイン画面へ遷移）

**実装ファイル**: `frontend/src/app/(public)/page.tsx`

### 3. サブスクリプション画面 (`/subscription`)
**目的**
Stripe決済によるサブスクリプション登録を提供する。

**構成要素**
- Stripe Checkoutセッション
- トライアル期間の説明
- 決済完了後のリダイレクト処理

**実装ファイル**: `frontend/src/app/(public)/subscription/page.tsx`

### 4. アプリ内トップページ (`/app`)
**目的**
子どもが自然にアプリを開始できるよう、キャラクターとの親しみやすい導入を提供する。

**構成要素**
- キャラクター(こころん)表示
- おしゃべりボタン（感情カード選択画面へ遷移）
- 今日の記録ボタン（今日の記録画面へ遷移）
- ハンバーガーメニュー
  - 使い方（Tips画面へ遷移）
  - ロールプレイ（ロールプレイ画面へ遷移）
  - レポート（レポート画面へ遷移）
  - アップグレード（決済画面へ遷移）
  - 設定（設定画面へ遷移）
  - ログアウト

**画面遷移ロジック**
- サブスクリプション未登録 → `/subscription`へリダイレクト
- 子ども設定未完了 → `/app/setup`へリダイレクト
- 正常 → トップページ表示

**実装ファイル**: `frontend/src/app/(authed)/app/page.tsx`

### 5. 初期設定画面 (`/app/setup`)
**目的**
子どものプロフィール情報を設定する。

**構成要素**
- 子どものニックネーム入力フォーム
- 年齢選択
- 設定完了ボタン

**実装ファイル**: `frontend/src/app/(authed)/app/setup/page.tsx`

### 6. 感情カード選択画面 (`/app/emotion-selection`)
**目的**
子どもが自分の感情を視覚的に選択できるようにする。

**構成要素**
- 13種類の感情カード（イラスト＋名称）
  - 黄色系: うれしい、ゆかい
  - 緑色系: あんしん、びっくり
  - 青色系: こわい、かなしい、こまった
  - 赤色系: ふゆかい、いかり、はずかしい、きんちょう
  - 灰色系: わからない
- 感情カードクリックで選択
- 「わからない」選択時は強度選択をスキップ

**画面遷移**
- 通常の感情 → 感情強度選択画面へ遷移
- 「わからない」 → 感情確認画面へ遷移（強度は「medium」固定）

**実装ファイル**: `frontend/src/app/(authed)/app/emotion-selection/page.tsx`

### 7. 感情強度選択画面 (`/app/emotion-intensity`)
**目的**
選んだ感情の強さを子どもが表現できるように促す。

**構成要素**
- キャラクター(こころん)表示
- キャラクターによる問いかけ
- 前画面の感情を確認できるUI
- 3段階の強度選択ボタン（よわい、ふつう、つよい）

**画面遷移**: 感情確認画面へ遷移

**実装ファイル**: `frontend/src/app/(authed)/app/emotion-intensity/page.tsx`

### 8. 感情確認画面 (`/app/emotion-confirmation`)
**目的**
感情カード選択時の誤操作防止のために選択した感情カードの確認をする。

**構成要素**
- キャラクター(こころん)による問いかけ
- 選択された感情カードの表示
- 右スワイプ：決定
- 左スワイプ：キャンセル

**実装ファイル**: `frontend/src/app/(authed)/app/emotion-confirmation/page.tsx`

### 9. 音声録音画面 (`/app/voice`)
**目的**
感情の背景にある体験や出来事を子ども自身の言葉で表現する練習を促す。

**構成要素**
- キャラクター(こころん)表示
- キャラクターによる問いかけ
- マイクボタン（録音開始/停止）
- 録音状態の視覚的フィードバック
- 録音完了後の文字起こし処理
- 応援メッセージ（ランダム切替）

**録音機能**
- WebM形式で録音
- S3へのアップロード
- Whisper APIによる文字起こし
- 録音データの再生機能

**画面遷移**: 録音完了後、入力完了画面へ遷移

**実装ファイル**: `frontend/src/app/(authed)/app/voice/page.tsx`

### 10. 入力完了画面 (`/app/voice/complete`)
**目的**
ユーザー体験をやさしく締めくくり、感情表現の成功体験として記憶づける。

**構成要素**
- こころんのイラスト
- キャラクター(こころん)によるコメント
- ホーム画面への戻るボタン

**実装ファイル**: `frontend/src/app/(authed)/app/voice/complete/page.tsx`

### 11. 今日の記録画面 (`/app/entries/today`)
**目的**
今日記録した感情データの確認と更新を提供する。

**構成要素**
- 今日の日付表示
- 記録の有無ステータス表示
- 既存記録の詳細表示（感情、強度、音声）


**実装ファイル**: `frontend/src/app/(authed)/app/entries/today/page.tsx`

### 12. レポート画面 (`/app/report`)
**目的**
子ども・保護者が感情の履歴を視覚的に把握し、傾向を認識できるようにする。

**構成要素**
- 日次レポート表示
- 週次レポート表示
- 感情タイプごとの色分け
- 強度の濃淡表現
- 音声テキストの表示

**実装ファイル**: `frontend/src/app/(authed)/app/report/page.tsx`

### 13. レポートガイド画面 (`/app/report-guide`)
**目的**
レポートの見方と活用方法を説明する。

**構成要素**
- レポートの見方説明
- 感情教育の重要性
- 保護者向けアドバイス

**実装ファイル**: `frontend/src/app/(authed)/app/report-guide/page.tsx`

### 14. ロールプレイ画面 (`/app/roleplay`)
**目的**
子どもが日常的なシチュエーションの中で共感力や想像力を育むことができるように導く。

**構成要素**
- シナリオ一覧表示
- シナリオ詳細モーダル
- 感情選択機能
- アドバイス表示

**実装ファイル**: `frontend/src/app/(authed)/app/roleplay/page.tsx`

### 15. 非認知能力画面 (`/app/non-cognitive`)
**目的**
非認知能力（EQ）についての説明を提供する。

**構成要素**
- 非認知能力の定義
- 重要性の説明
- 育成方法の紹介

**実装ファイル**: `frontend/src/app/(authed)/app/non-cognitive/page.tsx`

### 16. 使い方ガイド画面 (`/app/tips`)
**目的**
保護者に向けてアプリの目的・使い方・教育的意義をわかりやすく提示する。

**構成要素**
- 各機能の紹介
- 感情教育の説明
- 非認知能力の説明
- 保護者向けTips

**実装ファイル**: `frontend/src/app/(authed)/app/tips/page.tsx`

### 17. FAQ画面 (`/app/faq`)
**目的**
よくある質問と回答を提供する。

**構成要素**
- 質問一覧
- 回答表示
- カテゴリ別分類

**実装ファイル**: `frontend/src/app/(authed)/app/faq/page.tsx`

### 18. プライバシーポリシー画面 (`/app/privacy`)
**目的**
プライバシーポリシーを表示する。

**構成要素**
- プライバシーポリシー本文
- データ取り扱いの説明

**実装ファイル**: `frontend/src/app/(authed)/app/privacy/page.tsx`

### 19. 使い方画面 (`/app/usage`)
**目的**
本アプリの使い方を表示する。

**構成要素**
- アプリの基本的な使い方説明
- 感情記録の流れ
- 各機能の操作方法
- 保護者向けガイド

**実装ファイル**: `frontend/src/app/(authed)/app/usage/page.tsx`

### 20. 設定画面 (`/app/setting`)
**目的**
アプリの設定を管理する。

**構成要素**
- アカウント設定
- 通知設定
- その他の設定項目

**実装ファイル**: `frontend/src/app/(authed)/app/setting/page.tsx`

### 21. 決済管理画面 (`/app/payment/onboarding`)
**目的**
Stripe決済の設定と管理を提供する。

**構成要素**
- Stripe決済フォーム
- 支払い方法の設定
- サブスクリプション管理

**実装ファイル**: `frontend/src/app/(authed)/app/payment/onboarding/page.tsx`

### 22. 課金管理画面 (`/app/billing/manage`)
**目的**
サブスクリプションの管理と請求情報の確認を提供する。

**構成要素**
- 現在のプラン表示
- 請求履歴
- プラン変更機能

**実装ファイル**: `frontend/src/app/(authed)/billing/manage/page.tsx`

### 23. 404画面 (`/not-found`)
**目的**
存在しないページへのアクセス時のエラー表示。

**構成要素**
- エラーメッセージ
- ホーム画面への戻るボタン
- こころんの404キャラクター

**実装ファイル**: `frontend/src/app/not-found.tsx`

## 共通UIコンポーネント

### キャラクターコンポーネント
- `KokoronDefault` - デフォルトのこころん
- `KokoronBowing` - お辞儀するこころん
- `Kokoron404` - 404エラー用のこころん
- `KokoronReadingReport` - レポート読み取り中のこころん
- `KokoronWelcome` - 歓迎するこころん

### 基本UIコンポーネント
- `PrimaryButton` - プライマリボタン
- `SpeechBubble` - 吹き出し
- `Spinner` - ローディングスピナー
- `HamburgerMenu` - ハンバーガーメニュー
- `AudioPlayer` - 音声プレイヤー

## デザインシステム

### カラーパレット
- **プライマリ**: 感情の赤色系
- **セカンダリ**: 感情の青色系
- **アクセント**: 感情の黄色系
- **背景**: グラデーション（青系）

### 感情カラー
- 黄色系: #FFD700（うれしい、ゆかい）
- 緑色系: #00D4AA（あんしん、びっくり）
- 青色系: #0066FF（こわい、かなしい、こまった）
- 赤色系: #FF1744（ふゆかい、いかり、はずかしい、きんちょう）
- 灰色系: #424242（わからない）

### レイアウト
- **最大幅**: 430px（モバイルファースト）
- **カード最大幅**: 360px
- **角丸**: 20px（カード）、8px（ボタン）
- **余白**: 統一されたspacingシステム

## 3~5歳の特徴を考慮した設計

- **文字の読み書きが未習得** → 視覚的なUI、音声ガイド
- **スワイプ好き** → タップ操作中心、ドラッグ&ドロップ機能
- **見た目重視, カラフルなもの** → 感情カードの色分け、キャラクター活用
- **聴く専門** → 音声録音・再生機能
- **簡単な言葉** → ひらがな中心、ルビ付き
- **キャラクター反応度高い** → こころんの豊富な表情・動作
- **ボタン好き** → 大きなタップ領域（44px以上）
- **集中力が短い** → シンプルな操作、短時間で完了
- **シール・スタンプ大好き** → 視覚的フィードバック
- **大人の真似っこ大好き** → 録音・再生機能

### アクセシビリティ配慮

**タップ領域**: 44px以上を確保

**文字サイズ**: 14〜18px以上（WCAG準拠）

**色コントラスト**: 5:1以上を目標

**WCAG公式ガイドライン**
- 公式: https://www.w3.org/WAI/WCAG21/quickref/
- 総務省の日本語Ver.: https://waic.jp/docs/WCAG21/

**色コントラストチェックツール**
- WebAIM Contrast Checker: https://webaim.org/resources/contrastchecker/
- Colorable: https://colorable.jxnblk.com/
- Color Oracle: https://colororacle.org/
